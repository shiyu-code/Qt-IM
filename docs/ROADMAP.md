# Qt-IM 系统化升级路线图

## 阶段 1：稳定性与基础能力
- 增加心跳保活（Ping/Pong）与自动重连、断线提示（已完成：心跳）。
- 明确消息协议文档，统一类型和值域（新增 `docs/PROTOCOL.md`）。
- 整理配置项：服务器监听端口、文件端口、资源路径、日志开关。
- 基础日志与错误上报：关键路径使用结构化日志，便于定位问题。

## 阶段 2：协议与安全
- 统一 JSON 协议：约定 `type/from/data` 包装与字段含义、错误码体系。
- 会话鉴权：登录成功后下发 `sessionToken`，后续请求携带校验。
- 传输加密：优先支持 `QSslSocket`（TLS），至少为登录与敏感消息加密。

## 阶段 3：消息可靠性
- 送达确认（ACK）：客户端对 `SendMsg/SendGroupMsg` 进行 ack，失败重试。
- 离线消息：服务器持久化未读消息，登录或上线时批量下发。
- 去重与幂等：使用 `messageId` 保证重复消息不重复展示或持久化。

## 阶段 4：联系人与群组
- 好友请求与同意/拒绝流程完善（已有基本能力，补齐边界）。
- 群组角色与权限：群主/管理员/成员；禁言、踢人、公告等。
- 群通知与系统消息统一展示。

## 阶段 5：文件与媒体
- 文件断点续传与校验（MD5/SHA256）。
- 图片缩略与预览缓存；大图分块传输。
- 语音消息编码与跨平台播放（抽象驱动层，FMOD 可选）。

## 阶段 6：性能与运维
- 服务器并发连接优化：事件驱动与连接池，资源释放与限流。
- 数据库迁移与索引：历史消息索引、分页查询、搜索。
- 日志轮转与诊断：压缩与归档；崩溃日志收集。

## 阶段 7：体验与生态
- 跨平台打包与自动更新（Windows/MSI、macOS/dmg、Linux）。
- 插件框架：天气、机器人、自动回复、消息过滤。
- UI 主题与无障碍提升：高对比度主题、键盘操作优化。

## 里程碑与验收
- 每个阶段以可运行的功能集为里程碑，包含：
  - 可构建与运行、基础自动测试（模块级）。
  - README 与协议文档更新。
  - Demo 场景与操作说明（截图/录屏）。